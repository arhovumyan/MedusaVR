import{j as e,q as ue,I as he,F as fe}from"./ui-vendor-wCvZxCWV.js";import{r as p}from"./react-vendor-CgzYKCvO.js";import{D as Z,f as ee,a as te,g as T,c as ae,d as se}from"./dialog-kSi6stqE.js";import{L as ge,c as we,u as Ne}from"./routing-DoJeAdmJ.js";import{b as U}from"./query-vendor-BCFDQDjj.js";import{u as V,m as Ce,c as J,d as xe,e as $,B as y,l as pe,L as X,a as ne,b as Y,n as ke,h as Se,o as Me}from"./index-BosckDuJ.js";import{T as re}from"./tag-H0PVPXqJ.js";import{T as ie}from"./textarea-BxBvpGhc.js";import{C as ze,b as De,c as Ae,a as Pe}from"./card-CcnLzvpA.js";import{M as q,a6 as Fe,ab as _,S as Ie,X as oe,ac as le,H as Te,R as We,I as ce}from"./icons-BCb4Ufys.js";import{S as Le}from"./SEOHead-DHhpw9pg.js";import{B as qe}from"./Breadcrumb-Dz1eOKAg.js";import"./utils--BulIq_u.js";function Re(){const{isAuthenticated:t}=V(),{showSubscriptionModal:s}=Ce();return{requireAuth:(i="access this feature")=>t?!0:(s(i),!1),isAuthenticated:t}}const Ee=(t,s)=>{const n=["A mysterious figure whose past is shrouded in secrets, waiting for the right person to unlock their story.","An enigmatic soul with depths yet to be explored and tales yet to be told.","A complex character whose journey through life has shaped them into someone truly unique.","Someone with hidden talents and unexpected wisdom, ready to share their world with you.","A fascinating individual with layers of personality that reveal themselves over time.","An intriguing companion whose experiences have created a rich tapestry of stories to discover.","A charismatic presence with a unique perspective on life and love.","Someone whose journey has led them to seek meaningful connections and deep conversations.","A captivating spirit with dreams, ambitions, and a heart full of untold stories.","An alluring personality who brings both mystery and warmth to every interaction.","A dynamic individual whose past adventures have shaped their distinctive worldview.","Someone with an irresistible charm and a mind full of fascinating thoughts to share.","A compelling character whose life experiences have created a unique and engaging persona.","An enchanting soul who offers both intellectual stimulation and emotional depth.","A mysterious wanderer whose path through life has created countless stories worth discovering.","Someone whose complex nature promises hours of engaging conversation and connection.","A captivating individual with hidden depths and surprising revelations waiting to unfold.","An intriguing companion whose unique perspective makes every interaction memorable.","A fascinating character whose blend of mystery and openness creates an irresistible allure.","Someone whose journey through different worlds and experiences has shaped a truly unique personality.","A compelling presence whose stories and insights promise to captivate and inspire.","An enigmatic figure whose depths of character reveal themselves through meaningful connections.","A charismatic soul with a rich inner life and countless tales of adventure and romance.","Someone whose complex emotions and experiences create a personality that's impossible to forget.","A mysterious individual whose past holds secrets that slowly reveal themselves to those they trust.","An alluring character whose wisdom and charm make every moment spent together unforgettable.","A dynamic personality whose blend of strength and vulnerability creates an irresistible attraction.","Someone whose unique life path has created a character full of surprises and depth.","A captivating individual whose stories span different realms of experience and emotion.","An intriguing soul whose mysterious nature hides a warm heart and brilliant mind."],i=t?t.split("").reduce((d,l)=>d+l.charCodeAt(0),0):0,r=s?typeof s=="string"?parseInt(s)||0:s:0,o=i+r;return n[o%n.length]},G=p.forwardRef(({className:t,...s},n)=>e.jsx(ue,{ref:n,className:J("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s}));G.displayName=ue.displayName;const H=p.forwardRef(({className:t,...s},n)=>e.jsx(he,{ref:n,className:J("aspect-square h-full w-full",t),...s}));H.displayName=he.displayName;const B=p.forwardRef(({className:t,...s},n)=>e.jsx(fe,{ref:n,className:J("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s}));B.displayName=fe.displayName;function x(t){const s=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&s==="[object Date]"?new t.constructor(+t):typeof t=="number"||s==="[object Number]"||typeof t=="string"||s==="[object String]"?new Date(t):new Date(NaN)}function $e(t,s){return t instanceof Date?new t.constructor(s):new Date(s)}const W=43200,de=1440;let Oe={};function Ue(){return Oe}function me(t){const s=x(t),n=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return n.setUTCFullYear(s.getFullYear()),+t-+n}function L(t,s){const n=x(t),i=x(s),r=n.getTime()-i.getTime();return r<0?-1:r>0?1:r}function Xe(t){return $e(t,Date.now())}function Ye(t,s){const n=x(t),i=x(s),r=n.getFullYear()-i.getFullYear(),o=n.getMonth()-i.getMonth();return r*12+o}function _e(t){return s=>{const i=(t?Math[t]:Math.trunc)(s);return i===0?0:i}}function Ge(t,s){return+x(t)-+x(s)}function He(t){const s=x(t);return s.setHours(23,59,59,999),s}function Be(t){const s=x(t),n=s.getMonth();return s.setFullYear(s.getFullYear(),n+1,0),s.setHours(23,59,59,999),s}function Ve(t){const s=x(t);return+He(s)==+Be(s)}function Je(t,s){const n=x(t),i=x(s),r=L(n,i),o=Math.abs(Ye(n,i));let d;if(o<1)d=0;else{n.getMonth()===1&&n.getDate()>27&&n.setDate(30),n.setMonth(n.getMonth()-r*o);let l=L(n,i)===-r;Ve(x(t))&&o===1&&L(t,i)===1&&(l=!1),d=r*(o-Number(l))}return d===0?0:d}function Qe(t,s,n){const i=Ge(t,s)/1e3;return _e(n?.roundingMethod)(i)}const Ke={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},Ze=(t,s,n)=>{let i;const r=Ke[t];return typeof r=="string"?i=r:s===1?i=r.one:i=r.other.replace("{{count}}",s.toString()),n?.addSuffix?n.comparison&&n.comparison>0?"in "+i:i+" ago":i};function O(t){return(s={})=>{const n=s.width?String(s.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const et={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},tt={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},at={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},st={date:O({formats:et,defaultWidth:"full"}),time:O({formats:tt,defaultWidth:"full"}),dateTime:O({formats:at,defaultWidth:"full"})},nt={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},rt=(t,s,n,i)=>nt[t];function A(t){return(s,n)=>{const i=n?.context?String(n.context):"standalone";let r;if(i==="formatting"&&t.formattingValues){const d=t.defaultFormattingWidth||t.defaultWidth,l=n?.width?String(n.width):d;r=t.formattingValues[l]||t.formattingValues[d]}else{const d=t.defaultWidth,l=n?.width?String(n.width):t.defaultWidth;r=t.values[l]||t.values[d]}const o=t.argumentCallback?t.argumentCallback(s):s;return r[o]}}const it={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ot={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},lt={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},ct={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},dt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},mt={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},ut=(t,s)=>{const n=Number(t),i=n%100;if(i>20||i<10)switch(i%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},ht={ordinalNumber:ut,era:A({values:it,defaultWidth:"wide"}),quarter:A({values:ot,defaultWidth:"wide",argumentCallback:t=>t-1}),month:A({values:lt,defaultWidth:"wide"}),day:A({values:ct,defaultWidth:"wide"}),dayPeriod:A({values:dt,defaultWidth:"wide",formattingValues:mt,defaultFormattingWidth:"wide"})};function P(t){return(s,n={})=>{const i=n.width,r=i&&t.matchPatterns[i]||t.matchPatterns[t.defaultMatchWidth],o=s.match(r);if(!o)return null;const d=o[0],l=i&&t.parsePatterns[i]||t.parsePatterns[t.defaultParseWidth],b=Array.isArray(l)?gt(l,N=>N.test(d)):ft(l,N=>N.test(d));let u;u=t.valueCallback?t.valueCallback(b):b,u=n.valueCallback?n.valueCallback(u):u;const j=s.slice(d.length);return{value:u,rest:j}}}function ft(t,s){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&s(t[n]))return n}function gt(t,s){for(let n=0;n<t.length;n++)if(s(t[n]))return n}function xt(t){return(s,n={})=>{const i=s.match(t.matchPattern);if(!i)return null;const r=i[0],o=s.match(t.parsePattern);if(!o)return null;let d=t.valueCallback?t.valueCallback(o[0]):o[0];d=n.valueCallback?n.valueCallback(d):d;const l=s.slice(r.length);return{value:d,rest:l}}}const pt=/^(\d+)(th|st|nd|rd)?/i,bt=/\d+/i,vt={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},yt={any:[/^b/i,/^(a|c)/i]},jt={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wt={any:[/1/i,/2/i,/3/i,/4/i]},Nt={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Ct={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},kt={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},St={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},Mt={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},zt={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},Dt={ordinalNumber:xt({matchPattern:pt,parsePattern:bt,valueCallback:t=>parseInt(t,10)}),era:P({matchPatterns:vt,defaultMatchWidth:"wide",parsePatterns:yt,defaultParseWidth:"any"}),quarter:P({matchPatterns:jt,defaultMatchWidth:"wide",parsePatterns:wt,defaultParseWidth:"any",valueCallback:t=>t+1}),month:P({matchPatterns:Nt,defaultMatchWidth:"wide",parsePatterns:Ct,defaultParseWidth:"any"}),day:P({matchPatterns:kt,defaultMatchWidth:"wide",parsePatterns:St,defaultParseWidth:"any"}),dayPeriod:P({matchPatterns:Mt,defaultMatchWidth:"any",parsePatterns:zt,defaultParseWidth:"any"})},At={code:"en-US",formatDistance:Ze,formatLong:st,formatRelative:rt,localize:ht,match:Dt,options:{weekStartsOn:0,firstWeekContainsDate:1}};function Pt(t,s,n){const i=Ue(),r=n?.locale??i.locale??At,o=2520,d=L(t,s);if(isNaN(d))throw new RangeError("Invalid time value");const l=Object.assign({},n,{addSuffix:n?.addSuffix,comparison:d});let b,u;d>0?(b=x(s),u=x(t)):(b=x(t),u=x(s));const j=Qe(u,b),N=(me(u)-me(b))/1e3,h=Math.round((j-N)/60);let g;if(h<2)return n?.includeSeconds?j<5?r.formatDistance("lessThanXSeconds",5,l):j<10?r.formatDistance("lessThanXSeconds",10,l):j<20?r.formatDistance("lessThanXSeconds",20,l):j<40?r.formatDistance("halfAMinute",0,l):j<60?r.formatDistance("lessThanXMinutes",1,l):r.formatDistance("xMinutes",1,l):h===0?r.formatDistance("lessThanXMinutes",1,l):r.formatDistance("xMinutes",h,l);if(h<45)return r.formatDistance("xMinutes",h,l);if(h<90)return r.formatDistance("aboutXHours",1,l);if(h<de){const f=Math.round(h/60);return r.formatDistance("aboutXHours",f,l)}else{if(h<o)return r.formatDistance("xDays",1,l);if(h<W){const f=Math.round(h/de);return r.formatDistance("xDays",f,l)}else if(h<W*2)return g=Math.round(h/W),r.formatDistance("aboutXMonths",g,l)}if(g=Je(u,b),g<12){const f=Math.round(h/W);return r.formatDistance("xMonths",f,l)}else{const f=g%12,a=Math.trunc(g/12);return f<3?r.formatDistance("aboutXYears",a,l):f<9?r.formatDistance("overXYears",a,l):r.formatDistance("almostXYears",a+1,l)}}function Ft(t,s){return Pt(t,Xe(t),s)}function It({characterId:t,className:s=""}){const[n,i]=p.useState([]),[r,o]=p.useState(""),[d,l]=p.useState(null),[b,u]=p.useState(""),[j,N]=p.useState(!0),[h,g]=p.useState(!1),[f,a]=p.useState(1),[S,R]=p.useState(1),{user:z,isAuthenticated:C}=V(),{toast:M}=xe();p.useEffect(()=>{D()},[t,f]);const D=async()=>{try{N(!0);const c=await $.getCharacterComments(t,f,10);c.success&&(i(c.data),R(c.pagination.pages))}catch(c){console.error("Error fetching comments:",c),M({title:"Error",description:"Failed to load comments. Please try again.",variant:"destructive"})}finally{N(!1)}},F=async c=>{if(!C){M({title:"Sign in required",description:"You must be signed in to comment.",variant:"destructive"});return}const k=r;if(k.trim())try{g(!0);const v=await $.createComment(t,k,c);if(v.success)o(""),await D(),M({title:"Success",description:"Comment posted successfully!"});else throw new Error(v.error||"Failed to post comment")}catch(v){console.error("Error posting comment:",v),M({title:"Error",description:v.message||"Failed to post comment. Please try again.",variant:"destructive"})}finally{g(!1)}},E=async c=>{if(b.trim())try{(await $.updateComment(c,b)).success&&(l(null),u(""),await D(),M({title:"Success",description:"Comment updated successfully."}))}catch(k){console.error("Error editing comment:",k),M({title:"Error",description:"Failed to update comment. Please try again.",variant:"destructive"})}},I=({comment:c})=>{z?.id,c.userId._id;const k=Ft(new Date(c.createdAt),{addSuffix:!0});return e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(G,{className:"h-8 w-8",children:[e.jsx(H,{src:c.userId.avatarUrl,alt:c.userId.username}),e.jsx(B,{children:c.userId.username.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-sm",children:c.userId.username}),e.jsx("span",{className:"text-xs text-muted-foreground",children:k}),c.isEdited&&e.jsx("span",{className:"text-xs text-muted-foreground",children:"(edited)"})]}),d===c._id?e.jsxs("div",{className:"space-y-2",children:[e.jsx(ie,{value:b,onChange:v=>u(v.target.value),className:"min-h-[80px] bg-zinc-700/50 border-zinc-600",placeholder:"Edit your comment..."}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx(y,{size:"sm",onClick:()=>E(c._id),disabled:!b.trim(),children:"Save"}),e.jsx(y,{size:"sm",variant:"outline",onClick:()=>{l(null),u("")},children:"Cancel"})]})]}):e.jsx("p",{className:"text-sm text-zinc-300",children:c.content})]})]}),c.replies&&c.replies.length>0&&e.jsx("div",{className:"ml-11 space-y-3 pt-2 border-l-2 border-zinc-700 pl-4",children:c.replies.map(v=>e.jsx(I,{comment:v},v._id))})]})};return e.jsxs(ze,{className:`bg-zinc-800/50 border-orange-500/20 ${s}`,children:[e.jsx(De,{children:e.jsxs(Ae,{className:"text-orange-400 flex items-center gap-2",children:[e.jsx(q,{className:"w-5 h-5"}),"Comments (",n.length,")"]})}),e.jsxs(Pe,{className:"space-y-4",children:[C?e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsxs(G,{className:"h-8 w-8",children:[e.jsx(H,{src:z?.avatarUrl,alt:z?.username}),e.jsx(B,{children:z?.username?.charAt(0).toUpperCase()})]}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(ie,{value:r,onChange:c=>o(c.target.value),className:"min-h-[80px] bg-zinc-700/50 border-zinc-600",placeholder:"Share your thoughts about this character..."}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-xs text-muted-foreground",children:[r.length,"/1000"]}),e.jsx(y,{onClick:()=>F(),disabled:h||!r.trim(),size:"sm",className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700",children:h?"Posting...":e.jsxs(e.Fragment,{children:[e.jsx(Fe,{className:"w-3 h-3 mr-2"}),"Post Comment"]})})]})]})]})}):e.jsx("div",{className:"text-center py-4 text-zinc-400",children:e.jsx("p",{children:"Sign in to leave a comment"})}),e.jsx("div",{className:"space-y-4",children:j?e.jsxs("div",{className:"text-center py-8 text-zinc-400",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500 mx-auto mb-2"}),e.jsx("p",{children:"Loading comments..."})]}):n.length===0?e.jsxs("div",{className:"text-center py-8 text-zinc-400",children:[e.jsx(q,{className:"w-12 h-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"No comments yet."}),e.jsx("p",{className:"text-sm",children:"Be the first to share your thoughts!"})]}):n.map(c=>e.jsx(I,{comment:c},c._id))}),S>1&&e.jsxs("div",{className:"flex justify-center space-x-2 pt-4",children:[e.jsx(y,{variant:"outline",size:"sm",onClick:()=>a(c=>Math.max(1,c-1)),disabled:f===1,children:"Previous"}),e.jsxs("span",{className:"text-sm text-zinc-400 flex items-center",children:["Page ",f," of ",S]}),e.jsx(y,{variant:"outline",size:"sm",onClick:()=>a(c=>Math.min(S,c+1)),disabled:f===S,children:"Next"})]})]})]})}const Tt=({currentCharacterId:t,characterTags:s})=>{const{shouldBlurNSFW:n}=pe(),{data:i=[],isLoading:r}=U({queryKey:["similar-characters",t,s],queryFn:async()=>{try{const d=await(await Y("GET",`/api/characters?limit=6&exclude=${t}`,void 0,{},"low")).json();return d.data||d}catch(o){return console.error("Failed to fetch similar characters:",o),[]}},staleTime:5*60*1e3});return r?e.jsx("div",{className:"flex justify-center py-8",children:e.jsx(X,{size:"md",text:"Finding similar characters..."})}):i.length?e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:i.slice(0,6).map(o=>e.jsx(ge,{href:`/characters/${o.id}`,className:"group block",children:e.jsxs("div",{className:"bg-zinc-900/50 rounded-xl overflow-hidden border border-zinc-800/50 hover:border-orange-500/30 transition-all duration-300 hover:shadow-lg hover:shadow-orange-500/10",children:[e.jsxs("div",{className:"aspect-[3/4] relative overflow-hidden",children:[e.jsx("img",{src:o.avatar||o.avatarUrl||"/fallback.jpg",alt:`${o.name} - AI Character`,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-300",style:{filter:n(o.isNsfw||o.nsfw||!1)?"blur(10px)":void 0,opacity:n(o.isNsfw||o.nsfw||!1)?.7:void 0}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute bottom-3 left-3 right-3",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-white/90",children:[o.likes!==void 0&&e.jsxs("span",{className:"flex items-center gap-1 bg-black/60 px-2 py-1 rounded-full",children:[e.jsx(_,{size:14}),o.likes]}),(o.isNsfw||o.nsfw)&&e.jsx(ne,{variant:"secondary",className:"bg-red-600/80 text-white text-xs",children:"18+"})]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-white group-hover:text-orange-400 transition-colors duration-200 mb-2",children:o.name}),o.description&&e.jsx("p",{className:"text-sm text-zinc-400 line-clamp-2 mb-3",children:o.description}),o.tags&&o.tags.length>0&&e.jsxs("div",{className:"flex flex-wrap gap-1",children:[o.tags.slice(0,3).map((d,l)=>e.jsx(ne,{variant:"outline",className:"text-xs border-zinc-700 text-zinc-300 hover:border-orange-500/50",children:d},l)),o.tags.length>3&&e.jsxs("span",{className:"text-xs text-zinc-500",children:["+",o.tags.length-3," more"]})]})]})]})},o.id))}):null};function Bt(){xe();const t=p.useRef(null),[s,n]=we("/characters/:id"),[i,r]=Ne(),{isFavorite:o,toggleFavorite:d}=ke(),{requireAuth:l}=Re();Se();const{isBlurred:b,shouldBlurNSFW:u}=pe(),{isLiked:j,toggleLike:N}=Me(),{user:h}=V(),g=n?.id,f=g&&!isNaN(Number(g)),{data:a,error:S,isLoading:R,refetch:z}=U({queryKey:["character",g],queryFn:async()=>{if(!f)throw new Error("Invalid character ID");return await(await Y("GET",`/api/characters/${g}`,void 0,{},"high")).json()},enabled:!!f,staleTime:2*60*1e3,retry:(m,w)=>w?.isRateLimit||w?.status===429?!1:m<1}),{data:C=[],isLoading:M}=U({queryKey:["user-generated-images",h?.username,a?.name],queryFn:async()=>!h?.username||!a?.name?[]:(await(await Y("GET",`/api/image-generation/character/${g}`,void 0,{},"medium")).json()).data?.images||[],enabled:!!h?.username&&!!a?.name&&!!f,staleTime:3e4}),[D,F]=p.useState(a?.likes||0);p.useEffect(()=>{a?.likes!==void 0&&F(a.likes)},[a?.likes]);const E=async()=>{if(a?.id)try{const m=await N(parseInt(a.id,10));if(m===null){console.warn("Like request was throttled");return}m&&typeof m.likes=="number"&&F(m.likes),z()}catch(m){console.error("Failed to toggle like status:",m)}},I=()=>{l(`start a conversation with ${a?.name}`)&&(window.location.href=`/chat/${g}`)},c=()=>{l(`generate images with ${a?.name}`)&&r(`/generate-images?characterId=${a?.id}`)},k=({description:m})=>{const[w,ye]=p.useState(!1),K=m.length>100,je=K&&!w?m.substring(0,100)+"...":m;return e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm sm:text-base text-zinc-200 leading-relaxed",children:je}),K&&e.jsx(y,{variant:"link",onClick:()=>ye(!w),className:"p-0 h-auto text-orange-400 hover:text-orange-300",children:w?"Read Less":"Read More"})]})};if(!s||!f)return e.jsx("div",{className:"p-4 text-red-500",children:"Invalid character ID in URL."});if(S)return e.jsxs("div",{className:"p-4",children:[e.jsx("div",{className:"text-red-500 mb-2",children:"Failed to load character"}),e.jsx("div",{className:"text-sm text-gray-400",children:S?.isRateLimit?"Loading... please wait a moment":S.message||"Please try refreshing the page"})]});if(R||!a)return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-zinc-900 via-zinc-800 to-orange-900/20 text-white flex items-center justify-center",children:e.jsx(X,{size:"xl",text:"Loading character..."})});const v=a.tags?.map(m=>m).join(", ")||"",Q=a.description||Ee(a.name,a.id),be={"@context":"https://schema.org","@type":"Person",name:a.name,description:Q,image:a.avatar||a.avatarUrl,additionalType:"AICharacter",interactionStatistic:[{"@type":"InteractionCounter",interactionType:"https://schema.org/LikeAction",userInteractionCount:D}],keywords:v},ve=[{name:"Home",href:"/"},{name:"Characters",href:"/ForYouPage"},{name:a.name,href:`/characters/${a.id}`}];return e.jsxs(e.Fragment,{children:[e.jsx(Le,{title:`Chat with ${a.name} - AI GirlFriend | MedusaVR`,description:`Meet ${a.name}, an AI GirlFriend ready to chat. ${Q} Start conversations, generate images, and explore interactive experiences.`,keywords:`${a.name}, AI character, AI GirlFriend, chat bot, virtual GirlFriend, ${v}`,structuredData:be,image:a.avatar||a.avatarUrl}),e.jsxs("div",{className:"min-h-screen text-white",children:[e.jsx(qe,{items:ve}),e.jsxs("div",{className:"relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-zinc-900 via-zinc-800 to-zinc-900 opacity-90"}),e.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 py-6 sm:py-12",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 lg:gap-12 items-start",children:[e.jsx("div",{className:"relative group order-1 lg:order-none",children:e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs("div",{className:"aspect-[3/4] max-w-sm sm:max-w-md mx-auto lg:mx-0 relative overflow-hidden rounded-2xl bg-gradient-to-br from-zinc-800 to-zinc-900 border border-orange-500/20 shadow-2xl shadow-orange-500/10",children:[e.jsx("img",{src:a.avatar||"/fallback.jpg",alt:a.name,className:"w-full h-full object-cover transition-transform duration-500",style:{filter:u(a.isNsfw||!1)?"blur(20px)":void 0,opacity:u(a.isNsfw||!1)?.6:void 0}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/50 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 w-full max-w-xs px-4",children:e.jsx("div",{className:"bg-black/70 backdrop-blur-sm rounded-xl p-3 border border-orange-500/20",children:e.jsx("div",{className:"flex items-center justify-center text-sm",children:e.jsxs("div",{className:"flex items-center justify-center gap-5",children:[e.jsxs("span",{className:"flex items-center gap-1 text-green-400",children:[e.jsx(_,{size:16}),D]}),e.jsxs("span",{className:"flex items-center gap-1 text-orange-300",children:[e.jsx(q,{size:16}),a.totalWords?a.totalWords>1e3?`${(a.totalWords/1e3).toFixed(1)}K`:a.totalWords.toLocaleString():a.chatCount?a.chatCount>1e3?`${(a.chatCount/1e3).toFixed(1)}K`:a.chatCount.toLocaleString():"0"]}),e.jsxs("span",{className:"flex items-center gap-1 text-zinc-400",children:[e.jsx(Ie,{size:16}),a.rating??4.8]})]})})})})]})}),e.jsxs(te,{className:"max-w-none max-h-none w-screen h-screen p-0 border-none bg-black/80 backdrop-blur-md",onClick:m=>m.stopPropagation(),children:[e.jsx(T,{asChild:!0,children:e.jsx("div",{className:"absolute inset-0 z-0",onClick:()=>{}})}),e.jsx(ae,{className:"sr-only",children:"Character Avatar"}),e.jsx(se,{className:"sr-only",children:"Full-size view of the character's avatar. Click anywhere outside the image or press the X button to close."}),e.jsx(T,{asChild:!0,children:e.jsx("button",{className:"absolute top-6 right-6 z-50 w-12 h-12 rounded-full bg-black/30 hover:bg-white/20 flex items-center justify-center opacity-80 hover:opacity-100 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"Close image view",children:e.jsx(oe,{className:"w-6 h-6 text-white"})})}),e.jsx("div",{className:"flex items-center justify-center w-full h-full p-4 sm:p-8 pointer-events-none",children:e.jsx("img",{src:a.avatar||"/fallback.jpg",alt:"Character Avatar",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl pointer-events-auto",style:{maxWidth:"calc(100vw - 32px)",maxHeight:"calc(100vh - 32px)",filter:u(a.isNsfw||!1)?"blur(20px)":void 0,opacity:u(a.isNsfw||!1)?.6:void 0},onClick:m=>m.stopPropagation()})})]})]})}),e.jsxs("div",{className:"space-y-4 sm:space-y-6 order-2 lg:order-none",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl sm:text-3xl lg:text-4xl font-bold bg-gradient-to-r from-orange-400 to-orange-600 bg-clip-text text-transparent mb-3",children:a.name}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-3 p-2 sm:p-3 bg-zinc-800/50 backdrop-blur-sm rounded-xl border border-orange-500/20 mb-3",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full overflow-hidden bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center",children:a.creator?.avatarUrl?e.jsx("img",{src:a.creator.avatarUrl,alt:a.creator.username||"Creator",className:"w-full h-full object-cover"}):e.jsxs(e.Fragment,{children:[e.jsx(le,{size:16,className:"text-white sm:hidden"}),e.jsx(le,{size:20,className:"text-white hidden sm:block"})]})}),e.jsx("div",{className:"flex items-center gap-2 flex-1",children:e.jsxs("div",{className:"creator",children:[e.jsx("span",{className:"text-zinc-400 text-sm",children:"Created by "}),a.creator?.username&&a.creatorId?e.jsxs(ge,{href:`/user-profile/${a.creatorId}`,className:"font-semibold text-white hover:text-orange-400 transition-colors",children:["@",a.creator.username]}):e.jsx("span",{className:"font-semibold text-white",children:"@Unknown"}),a.creator?.verified&&e.jsx("span",{className:"ml-1 text-yellow-500",title:"Verified Creator",children:"✓"})]})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 sm:gap-4 mb-3",children:[e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-zinc-800/30 backdrop-blur-sm rounded-xl border border-orange-500/10",children:[e.jsx("div",{className:"text-xs text-zinc-400",children:"Created"}),e.jsx("div",{className:"text-sm sm:text-base font-bold text-orange-400",children:a.createdAt?new Date(a.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"July 2, 2025"})]}),e.jsxs("div",{className:"text-center p-3 sm:p-4 bg-zinc-800/30 backdrop-blur-sm rounded-xl border border-orange-500/10",children:[e.jsx("div",{className:"text-xs text-zinc-400",children:"Last Updated"}),e.jsx("div",{className:"text-sm sm:text-base font-bold text-orange-400",children:a.updatedAt?new Date(a.updatedAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"July 2, 2025"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 sm:gap-4 mb-3",children:[e.jsxs(y,{variant:"outline",size:"lg",onClick:E,className:`border-orange-500/30 transition-all duration-200 h-16 rounded-xl ${j(parseInt(a.id,10))?"text-blue-500 hover:bg-blue-500/10 hover:border-blue-500/50":"text-orange-300 hover:bg-orange-500/10 hover:border-orange-500/50"}`,children:[e.jsx(_,{size:20,className:"mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Like"})]}),e.jsxs(y,{variant:"outline",size:"lg",onClick:()=>{a&&d({id:a.id.toString(),avatar:a.avatarUrl||a.avatar||"",name:a.name,description:a.persona||"No description available",rating:a.isNsfw?"R":"PG",nsfw:a.isNsfw||!1,chatCount:a.totalWords||a.chatCount||0})},className:`border-orange-500/30 transition-all duration-200 h-16 rounded-xl ${o(a?.id)?"text-red-500 hover:bg-red-500/10 hover:border-red-500/50":"text-orange-300 hover:bg-orange-500/10 hover:border-orange-500/50"}`,children:[e.jsx(Te,{size:20,className:"mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Favorite"})]}),e.jsxs(y,{variant:"outline",size:"lg",onClick:()=>t.current?.scrollIntoView({behavior:"smooth"}),className:"border-orange-500/30 text-orange-300 hover:bg-orange-500/10 hover:border-orange-500/50 transition-all duration-200 h-16 rounded-xl",children:[e.jsx(We,{size:20,className:"mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Comment"})]})]})]}),e.jsxs("div",{className:"p-4 sm:p-6 bg-zinc-800/30 backdrop-blur-sm rounded-xl border border-orange-500/10",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-orange-300 mb-3",children:"About"}),e.jsx(k,{description:a.description||a.persona||"No description available"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-zinc-400 mb-3",children:"Categories & Tags"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.selectedTags&&Object.values(a.selectedTags).some(m=>m&&m.length>0)?e.jsx(re,{tags:Object.values(a.selectedTags).flat().filter(Boolean),buttonStyle:!0,clickable:!0,className:"gap-2"}):e.jsx(re,{tags:["romance","fantasy","caring"],buttonStyle:!0,clickable:!0,className:"gap-2"}),a.isNsfw&&e.jsxs(y,{variant:"outline",size:"sm",className:"border-red-500/30 text-red-300 hover:bg-red-500/10 hover:border-red-500/50 transition-all duration-200 gap-1.5",children:[e.jsx("span",{className:"text-sm",children:"🔞"}),e.jsx("span",{children:"NSFW"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs(y,{size:"lg",className:"bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white shadow-xl shadow-orange-500/25 transition-all duration-200 hover:scale-105 h-16 sm:h-20 text-sm sm:text-base",onClick:I,children:[e.jsx(q,{size:16,className:"mr-1 sm:mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Start Chat"})]}),e.jsxs(y,{variant:"outline",size:"lg",className:"border-orange-500/30 text-orange-300 hover:bg-orange-500/10 hover:border-orange-500/50 transition-all duration-200 h-16 sm:h-20 text-sm sm:text-base",onClick:c,children:[e.jsx(ce,{size:16,className:"mr-1 sm:mr-2 flex-shrink-0"}),e.jsx("span",{className:"hidden sm:inline truncate",children:"Generate"}),e.jsx("span",{className:"sm:hidden truncate",children:"Generate"})]}),e.jsxs(y,{variant:"outline",size:"lg",className:"border-orange-500/30 text-orange-300 hover:bg-orange-500/10 hover:border-orange-500/50 transition-all duration-200 h-16 sm:h-20 text-sm sm:text-base",onClick:()=>{l("view this character's images")&&(window.location.href=`/user-gallery/character/${g}`)},children:[e.jsx(ce,{size:16,className:"mr-1 sm:mr-2 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:"Images"})]})]}),e.jsxs("div",{className:"bg-zinc-800/30 backdrop-blur-sm rounded-xl border border-orange-500/10 p-4 sm:p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-orange-300",children:"Your Generated Images"}),e.jsx("span",{className:"text-xs text-zinc-400",children:C.length>0?`${C.length} images`:"Gallery"})]}),M?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(X,{size:"sm",text:"Loading your images..."})}):C.length>0?e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:[C.slice(0,12).map((m,w)=>e.jsxs(Z,{children:[e.jsx(ee,{asChild:!0,children:e.jsxs("div",{className:"aspect-square bg-zinc-700/50 rounded-lg border border-orange-500/20 relative overflow-hidden group hover:border-orange-500/40 transition-colors cursor-pointer",children:[e.jsx("img",{src:m.url,alt:`Generated image ${w+1}`,className:"w-full h-full object-cover transition-transform duration-300 group-hover:scale-105",style:{filter:u(a.isNsfw||!1)?"blur(10px)":void 0,opacity:u(a.isNsfw||!1)?.8:void 0}}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-300"}),e.jsx("div",{className:"absolute bottom-2 left-2 right-2 text-xs text-zinc-300 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:m.filename||`Image ${w+1}`})]})}),e.jsxs(te,{className:"max-w-none max-h-none w-screen h-screen p-0 border-none bg-black/90 backdrop-blur-md",children:[e.jsx(T,{asChild:!0,children:e.jsx("div",{className:"absolute inset-0 z-0"})}),e.jsx(ae,{className:"sr-only",children:"Generated Image"}),e.jsx(se,{className:"sr-only",children:"Full-size view of generated image"}),e.jsx(T,{asChild:!0,children:e.jsx("button",{className:"absolute top-6 right-6 z-50 w-12 h-12 rounded-full bg-black/30 hover:bg-white/20 flex items-center justify-center opacity-80 hover:opacity-100 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"Close image view",children:e.jsx(oe,{className:"w-6 h-6 text-white"})})}),e.jsx("div",{className:"flex items-center justify-center w-full h-full p-4 sm:p-8",children:e.jsx("img",{src:m.url,alt:"Generated Image",className:"max-w-full max-h-full object-contain rounded-lg shadow-2xl",style:{maxWidth:"calc(100vw - 32px)",maxHeight:"calc(100vh - 32px)",filter:u(a.isNsfw||!1)?"blur(10px)":void 0,opacity:u(a.isNsfw||!1)?.8:void 0}})})]})]},m.url||w)),C.length>12&&e.jsx("div",{className:"aspect-square bg-zinc-700/30 rounded-lg border border-orange-500/20 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("span",{className:"text-sm text-zinc-400",children:["+",C.length-12]}),e.jsx("div",{className:"text-xs text-zinc-500 mt-1",children:"more images"})]})})]}):e.jsx("div",{className:"text-center py-8 text-zinc-500",children:h?e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm",children:"You haven't generated any images with this character yet"}),e.jsx("p",{className:"text-xs mt-1",children:'Click "Generate Images" to create your first image!'})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm",children:"Sign in to see your generated images"}),e.jsx("p",{className:"text-xs mt-1",children:"Your personal gallery will appear here"})]})})]})]})]})})]}),e.jsx("div",{className:"mt-16 pt-8 border-t border-zinc-800/50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-8 text-center",children:"Similar Characters"}),e.jsx(Tt,{currentCharacterId:a.id,characterTags:a.tags||[]})]})}),e.jsx("div",{ref:t,className:"mt-16 pt-8 border-t border-zinc-800/50",children:e.jsx(It,{characterId:g})})]})]})}export{Bt as default};
