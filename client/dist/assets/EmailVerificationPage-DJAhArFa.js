import{j as e}from"./ui-vendor-yJ52fMSG.js";import{r as n}from"./react-vendor-CgzYKCvO.js";import{b,d as C}from"./routing-DoJeAdmJ.js";import{d as k,B as c}from"./index-RHqJfvrp.js";import{C as E,b as V,c as R,d as S,a as P}from"./card-CLyBdkuB.js";import{L as x,s as p,N as T,f as B,R as y}from"./icons-CPY5GJO9.js";import"./query-vendor-8KRGqY0G.js";import"./utils--BulIq_u.js";function D(){const[v]=b(),u=C(),{toast:r}=k(),[s,t]=n.useState("loading"),[a,l]=n.useState(null),[f,g]=n.useState(!1),d=v.get("token");n.useEffect(()=>{if(!d){t("error"),l({success:!1,message:"No verification token provided. Please check your email link."});return}j(d)},[d]);const j=async o=>{try{const m=await(await fetch(`/api/auth/verify-email?token=${o}`,{method:"GET",headers:{"Content-Type":"application/json"}})).json();l(m),m.success?(t("success"),r({title:"Email Verified Successfully!",description:"Your account is now active. You can log in to start using MedusaVR."})):(t("error"),r({title:"Verification Failed",description:m.message,variant:"destructive"}))}catch(i){console.error("Email verification error:",i),t("error"),l({success:!1,message:"An error occurred while verifying your email. Please try again."}),r({title:"Verification Error",description:"An unexpected error occurred. Please try again.",variant:"destructive"})}},w=async()=>{if(a?.user?.email){g(!0);try{const i=await(await fetch("/api/auth/resend-verification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.user.email})})).json();i.success?r({title:"Verification Email Sent",description:"Please check your inbox for a new verification email."}):r({title:"Failed to Resend",description:i.message,variant:"destructive"})}catch(o){console.error("Resend verification error:",o),r({title:"Error",description:"Failed to resend verification email. Please try again.",variant:"destructive"})}finally{g(!1)}}},N=()=>{u("/",{replace:!0})},h=()=>{u("/",{replace:!0})};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-900 via-black to-gray-900 flex items-center justify-center p-4",children:e.jsxs(E,{className:"w-full max-w-md bg-gray-800/50 border-gray-700 backdrop-blur-lg",children:[e.jsxs(V,{className:"text-center space-y-2",children:[e.jsxs("div",{className:"mx-auto mb-4 flex items-center justify-center w-16 h-16 rounded-full bg-gradient-to-r from-orange-500 to-red-500",children:[s==="loading"&&e.jsx(x,{className:"h-8 w-8 text-white animate-spin"}),s==="success"&&e.jsx(p,{className:"h-8 w-8 text-white"}),s==="error"&&e.jsx(T,{className:"h-8 w-8 text-white"})]}),e.jsxs(R,{className:"text-2xl font-bold text-white",children:[s==="loading"&&"Verifying Your Email...",s==="success"&&"Email Verified!",s==="error"&&"Verification Failed"]}),e.jsxs(S,{className:"text-gray-300",children:[s==="loading"&&"Please wait while we verify your email address.",s==="success"&&"Your account is now active and ready to use.",s==="error"&&"We encountered an issue verifying your email."]})]}),e.jsxs(P,{className:"space-y-4",children:[a&&e.jsx("div",{className:`p-4 rounded-lg border ${a.success?"bg-green-500/10 border-green-500/20 text-green-400":"bg-red-500/10 border-red-500/20 text-red-400"}`,children:e.jsx("p",{className:"text-sm",children:a.message})}),s==="success"&&e.jsx("div",{className:"space-y-3",children:e.jsxs(c,{onClick:N,className:"w-full bg-gradient-to-r from-orange-500 to-red-500 hover:from-orange-600 hover:to-red-600 text-white font-semibold",children:[e.jsx(p,{className:"mr-2 h-4 w-4"}),"Continue to Login"]})}),s==="error"&&e.jsxs("div",{className:"space-y-3",children:[a?.user?.email&&e.jsx(c,{onClick:w,disabled:f,variant:"outline",className:"w-full border-gray-600 text-gray-300 hover:bg-gray-700",children:f?e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(B,{className:"mr-2 h-4 w-4"}),"Resend Verification Email"]})}),e.jsxs(c,{onClick:h,variant:"ghost",className:"w-full text-gray-400 hover:text-white hover:bg-gray-700",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Back to Home"]})]}),s==="loading"&&e.jsx("div",{className:"flex justify-center",children:e.jsxs(c,{onClick:h,variant:"ghost",className:"text-gray-400 hover:text-white hover:bg-gray-700",children:[e.jsx(y,{className:"mr-2 h-4 w-4"}),"Back to Home"]})})]})]})})}export{D as default};
