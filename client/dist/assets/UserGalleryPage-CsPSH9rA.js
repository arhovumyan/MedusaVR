import{j as e}from"./ui-vendor-yJ52fMSG.js";import{r as j}from"./react-vendor-CgzYKCvO.js";import{b as f}from"./query-vendor-8KRGqY0G.js";import{L as v}from"./routing-DoJeAdmJ.js";import{u as N,L as w,b as y}from"./index-BjPJS_Ij.js";import{I as k,Q as g,ai as z,X as I,aj as C,ak as L}from"./icons-B1tK8ZjU.js";import"./utils--BulIq_u.js";function P(){const{user:c}=N(),[s,i]=j.useState(null),{data:o,isLoading:b,error:u}=f({queryKey:["user-gallery",c?.username],queryFn:async()=>(await y("GET",`/api/user-gallery/${c?.username}`,void 0,{},"medium")).json(),enabled:!!c?.username}),d=async(a,r)=>{try{const l=await(await fetch(a)).blob(),h=window.URL.createObjectURL(l),n=document.createElement("a");n.href=h,n.download=r,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(h)}catch(t){console.error("Download failed:",t),window.open(a,"_blank")}},p=(a,r,t)=>{i({image:a,groupImages:r,index:t})},m=()=>{i(null)},x=a=>{if(!s)return;const{groupImages:r,index:t}=s;let l;a==="prev"?l=t>0?t-1:r.length-1:l=t<r.length-1?t+1:0,i({image:r[l],groupImages:r,index:l})};return c?e.jsx("div",{className:"min-h-screen bg-zinc-900 text-white",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold bg-gradient-to-r from-orange-400 to-orange-600 bg-clip-text text-transparent",children:"Your Image Gallery"}),e.jsx("p",{className:"text-zinc-400 mt-1",children:"All images you generated across characters"})]}),b?e.jsx("div",{className:"flex items-center justify-center py-16",children:e.jsx(w,{size:"lg",text:"Loading your gallery..."})}):u?e.jsx("div",{className:"text-center text-zinc-400 py-16",children:e.jsx("p",{children:"Failed to load your gallery."})}):o&&o.characterGroups.length>0?e.jsx("div",{className:"space-y-8",children:o.characterGroups.map(a=>e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 shadow-2xl shadow-orange-500/10 rounded-lg",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a.characterAvatar?e.jsx("img",{src:a.characterAvatar,alt:a.characterName,className:"w-10 h-10 rounded-md object-cover border border-orange-500/30"}):e.jsx("div",{className:"w-10 h-10 rounded-md border border-orange-500/30 bg-zinc-800/50 flex items-center justify-center text-orange-300",children:e.jsx(k,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold",children:a.characterName}),e.jsxs("p",{className:"text-sm text-zinc-400",children:[a.totalImages," image",a.totalImages===1?"":"s"]})]})]}),e.jsx("div",{children:e.jsx(v,{href:`/user-gallery/character/${a.characterId}`,children:e.jsx("button",{className:"border border-orange-500/40 text-orange-300 hover:bg-orange-500/10 px-4 py-2 rounded-md transition-colors",children:"View all"})})})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6 gap-3",children:a.images.map((r,t)=>e.jsxs("div",{className:"group cursor-pointer relative overflow-hidden rounded-lg border border-orange-500/20 bg-zinc-800/40",onClick:()=>p(r,a.images,t),children:[e.jsx("img",{src:r.url,alt:`${a.characterName}`,className:"w-full h-auto object-contain group-hover:scale-105 transition-transform duration-300",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 transition-colors duration-300"}),e.jsx("div",{className:"absolute bottom-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("button",{onClick:l=>{l.stopPropagation(),d(r.url,`${a.characterName}_image_${t+1}.png`)},className:"p-1.5 bg-black/60 text-white rounded-full hover:bg-black/80 transition-colors",children:e.jsx(g,{size:16})})})]},r.id))})]})},a.characterId))}):e.jsxs("div",{className:"bg-zinc-800/50 border border-orange-500/20 rounded-lg p-12 text-center",children:[e.jsx(z,{className:"w-12 h-12 text-zinc-600 mx-auto mb-4"}),e.jsx("div",{className:"text-zinc-300 mb-1",children:"No images found"}),e.jsx("div",{className:"text-zinc-500 text-sm",children:"Generate images with characters and they will appear here."})]}),s&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-2 sm:p-4",onClick:m,children:e.jsxs("div",{className:"relative bg-zinc-800/90 backdrop-blur-md rounded-lg w-full h-full max-w-6xl max-h-full overflow-hidden border border-orange-500/30 flex flex-col",style:{maxWidth:"calc(100vw - 16px)",maxHeight:"calc(100vh - 16px)"},onClick:a=>a.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-2 sm:p-4 border-b border-orange-500/20 flex-shrink-0",children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("h3",{className:"text-white font-semibold text-sm sm:text-base truncate",children:s.image.characterName}),e.jsxs("p",{className:"text-zinc-300 text-xs sm:text-sm",children:["Image ",s.index+1," of ",s.groupImages.length]})]}),e.jsxs("div",{className:"flex items-center space-x-2 flex-shrink-0",children:[e.jsx("button",{onClick:()=>d(s.image.url,`${s.image.characterName}_image_${s.index+1}.png`),className:"bg-orange-600 hover:bg-orange-700 text-white p-1.5 sm:p-2 rounded-lg transition-colors",children:e.jsx(g,{size:16,className:"w-4 h-4 sm:w-5 sm:h-5"})}),e.jsx("button",{onClick:m,className:"bg-zinc-700 hover:bg-zinc-600 text-white p-1.5 sm:p-2 rounded-lg transition-colors",children:e.jsx(I,{size:16,className:"w-4 h-4 sm:w-5 sm:h-5"})})]})]}),e.jsxs("div",{className:"relative flex-1 flex items-center justify-center p-2",children:[e.jsx("img",{src:s.image.url,alt:`${s.image.characterName} image ${s.index+1}`,className:"max-w-full max-h-full object-contain mx-auto block",style:{maxWidth:"calc(100vw - 64px)",maxHeight:"calc(100vh - 120px)"}}),s.groupImages.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>x("prev"),className:"absolute left-2 sm:left-4 top-1/2 -translate-y-1/2 bg-black/60 hover:bg-black/80 text-white p-1.5 sm:p-2 rounded-full transition-colors",children:e.jsx(C,{size:20,className:"w-4 h-4 sm:w-6 sm:h-6"})}),e.jsx("button",{onClick:()=>x("next"),className:"absolute right-2 sm:right-4 top-1/2 -translate-y-1/2 bg-black/60 hover:bg-black/80 text-white p-1.5 sm:p-2 rounded-full transition-colors",children:e.jsx(L,{size:20,className:"w-4 h-4 sm:w-6 sm:h-6"})})]})]})]})})]})}):e.jsx("div",{className:"min-h-screen bg-zinc-900 text-white flex items-center justify-center p-6",children:e.jsx("div",{className:"bg-zinc-800/50 border border-orange-500/20 rounded-lg p-8 text-center",children:e.jsx("p",{className:"text-zinc-300",children:"Please sign in to view your image gallery."})})})}export{P as default};
