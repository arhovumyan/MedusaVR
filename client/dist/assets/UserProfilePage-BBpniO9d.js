import{j as e}from"./ui-vendor-yJ52fMSG.js";import{r as g,a as D}from"./react-vendor-CgzYKCvO.js";import{a as Q,L as x}from"./routing-DoJeAdmJ.js";import{u as V,b as c}from"./query-vendor-8KRGqY0G.js";import{C as _}from"./cards-BL7pjZa4.js";import{u as B,f as R,b as i}from"./index-14IbRwle.js";import{B as M}from"./BrandingFooter-DTfuZIBt.js";import{P as O}from"./ProfilePictureUpload-B8_FbYDs.js";import{C as u,ae as $,P as Y,m as H,af as y,r as p}from"./icons-CPY5GJO9.js";import"./utils--BulIq_u.js";const z="/placeholder-avatar.png",oe=()=>{const{user:l,isAuthenticated:f,refreshUser:q}=B(),{id:d}=Q(),[m,S]=g.useState("Characters"),[b,w]=g.useState(!1),[j,C]=g.useState(!1),k=V(),t=!d||d===l?.id,a=d||l?.id;g.useEffect(()=>{!d&&l?.id&&window.history.replaceState(null,"",`/user-profile/${l.id}`)},[d,l?.id]);const n=!!(a&&a!=="undefined"&&a!==":id"),{data:F}=c({queryKey:["user","profile"],queryFn:R.getProfile,enabled:f,refetchInterval:6e4}),{data:T}=c({queryKey:["user",a],queryFn:async()=>t?F||l:n?await(await i("GET",`/api/users/${a}`)).json():null,enabled:n}),{data:h=[],isLoading:E}=c({queryKey:["user-characters",a],queryFn:async()=>n?await(await i("GET",`/api/characters/creator/${a}`)).json():[],enabled:n}),{data:N,isLoading:P}=c({queryKey:["user-followers",a],queryFn:async()=>n?await(await i("GET",`/api/follows/users/${a}/followers`)).json():{data:[]},enabled:n}),{data:L,isLoading:U}=c({queryKey:["user-following",a],queryFn:async()=>n?await(await i("GET",`/api/follows/users/${a}/following`)).json():{data:[]},enabled:n}),{data:v}=c({queryKey:["follow-status",a],queryFn:async()=>!n||t?{isFollowing:!1}:await(await i("GET",`/api/follows/users/${a}/follow-status`)).json(),enabled:n&&!t&&f});D.useEffect(()=>{v&&w(v.isFollowing)},[v]);const I=async()=>{if(!(!f||!n||t)){C(!0);try{b?(await i("DELETE",`/api/follows/users/${a}/follow`),w(!1)):(await i("POST",`/api/follows/users/${a}/follow`),w(!0)),k.invalidateQueries({queryKey:["follow-status",a]}),k.invalidateQueries({queryKey:["user-followers",a]})}catch(r){console.error("Follow toggle error:",r)}finally{C(!1)}}},o=T||F||l,K=o?.coins||0,A=["Characters","Followers","Following"],G=()=>{if(m==="Characters")return E?e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-6 sm:p-8 lg:p-12 text-center shadow-2xl shadow-orange-500/10",children:e.jsx("div",{className:"text-zinc-400",children:"Loading characters..."})}):h.length===0?e.jsxs("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-6 sm:p-8 lg:p-12 text-center shadow-2xl shadow-orange-500/10",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-4 bg-orange-500/20 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-6 h-6 sm:w-8 sm:h-8 text-orange-400"})}),e.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-zinc-200 mb-2",children:"It's a bit empty here"}),e.jsx("p",{className:"text-sm sm:text-base text-zinc-400 mb-6",children:t?"Create your first public character to get started":"This user hasn't created any characters yet"}),t&&e.jsx(x,{href:"/create-character",children:e.jsx("button",{className:"px-6 sm:px-8 py-2.5 sm:py-3 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 rounded-xl transition-all duration-200 transform hover:scale-105 text-sm sm:text-base",children:"Create Character"})})]}):e.jsx(_,{externalCharacters:h,externalLoading:!1,externalError:null});if(m==="Followers"){if(P)return e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-6 sm:p-8 lg:p-12 text-center shadow-2xl shadow-orange-500/10",children:e.jsx("div",{className:"text-zinc-400",children:"Loading followers..."})});const r=N?.data||[];return r.length===0?e.jsxs("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-6 sm:p-8 lg:p-12 text-center shadow-2xl shadow-orange-500/10",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-4 bg-orange-500/20 rounded-full flex items-center justify-center",children:e.jsx(y,{className:"w-6 h-6 sm:w-8 sm:h-8 text-orange-400"})}),e.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-zinc-200 mb-2",children:"It's a bit empty here"}),e.jsx("p",{className:"text-sm sm:text-base text-zinc-400 mb-6",children:t?"No followers yet":"This user has no followers yet"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:r.map(s=>e.jsx(x,{href:`/user-profile/${s._id||s.id}`,children:e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-xl p-4 shadow-lg shadow-orange-500/10 hover:shadow-orange-500/20 transition-all duration-300 cursor-pointer group",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.avatarUrl||z,alt:s.username,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-200 truncate",children:s.username}),s.isVerified&&e.jsx(u,{className:"w-4 h-4 text-yellow-500 shrink-0"})]}),s.bio&&e.jsx("p",{className:"text-xs text-zinc-400 truncate",children:s.bio}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-zinc-500 mt-1",children:[e.jsxs("span",{children:[s.followersCount||0," followers"]}),e.jsxs("span",{children:[s.followingCount||0," following"]})]})]})]})})},s._id||s.id||`follower-${Math.random()}`))})}if(m==="Following"){if(U)return e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-6 sm:p-8 lg:p-12 text-center shadow-2xl shadow-orange-500/10",children:e.jsx("div",{className:"text-zinc-400",children:"Loading following..."})});const r=L?.data||[];return r.length===0?e.jsxs("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-6 sm:p-8 lg:p-12 text-center shadow-2xl shadow-orange-500/10",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-4 bg-orange-500/20 rounded-full flex items-center justify-center",children:e.jsx(p,{className:"w-6 h-6 sm:w-8 sm:h-8 text-orange-400"})}),e.jsx("h2",{className:"text-lg sm:text-xl lg:text-2xl font-semibold text-zinc-200 mb-2",children:"It's a bit empty here"}),e.jsx("p",{className:"text-sm sm:text-base text-zinc-400 mb-6",children:t?"You're not following anyone yet":"This user isn't following anyone yet"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 sm:gap-6",children:r.map(s=>e.jsx(x,{href:`/user-profile/${s._id||s.id}`,children:e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-xl p-4 shadow-lg shadow-orange-500/10 hover:shadow-orange-500/20 transition-all duration-300 cursor-pointer group",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:s.avatarUrl||z,alt:s.username,className:"w-12 h-12 rounded-full object-cover"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-semibold text-zinc-200 truncate",children:s.username}),s.isVerified&&e.jsx(u,{className:"w-4 h-4 text-yellow-500 shrink-0"})]}),s.bio&&e.jsx("p",{className:"text-xs text-zinc-400 truncate",children:s.bio}),e.jsxs("div",{className:"flex items-center space-x-4 text-xs text-zinc-500 mt-1",children:[e.jsxs("span",{children:[s.followersCount||0," followers"]}),e.jsxs("span",{children:[s.followingCount||0," following"]})]})]})]})})},s._id||s.id||`following-${Math.random()}`))})}return null};return e.jsx("div",{className:"text-white px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("header",{className:"mb-6 sm:mb-8",children:e.jsxs("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-2xl p-4 sm:p-6 lg:p-8 shadow-2xl shadow-orange-500/10",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-6 mb-6",children:[e.jsx("div",{className:"relative shrink-0",children:t?e.jsx(O,{currentAvatarUrl:l?.avatarUrl||l?.avatar,onAvatarUpdate:async r=>{await q()}}):e.jsx("img",{src:o?.avatarUrl||o?.avatar||z,alt:o?.username||"User",className:"w-20 h-20 sm:w-24 sm:h-24 rounded-full object-cover ring-4 ring-orange-500/30"})}),e.jsxs("div",{className:"flex-1 w-full min-w-0",children:[e.jsxs("div",{className:"flex flex-col xs:flex-row xs:items-center space-y-2 xs:space-y-0 xs:space-x-3 mb-2",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold bg-gradient-to-r from-orange-400 to-orange-600 bg-clip-text text-transparent truncate",children:o?.username||"Guest User"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[o?.isVerified&&e.jsx(u,{className:"w-5 h-5 sm:w-6 sm:h-6 text-yellow-500 shrink-0"}),e.jsxs("button",{"aria-label":"Copy profile link",className:"text-zinc-400 hover:text-orange-400 transition-colors shrink-0",children:[e.jsx($,{size:18,className:"sm:hidden"}),e.jsx($,{size:20,className:"hidden sm:block"})]})]})]}),e.jsxs("p",{className:"text-sm sm:text-base text-zinc-400 mb-3 truncate-mobile-2",children:["@",o?.username||"guest"," • ",o?.role||"user"," • ",N?.data?.length||0," followers • ",h.length||0," characters"]}),o?.bio&&e.jsx("p",{className:"text-sm sm:text-base text-zinc-300 mb-3 truncate-mobile-3",children:o.bio})]})]}),e.jsx("div",{className:"flex flex-col xs:flex-row space-y-3 xs:space-y-0 xs:space-x-4",children:t?e.jsxs(e.Fragment,{children:[e.jsx(x,{href:"/create-character",children:e.jsxs("button",{className:"px-4 sm:px-6 py-2.5 sm:py-3 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 rounded-xl transition-all duration-200 transform hover:scale-105 flex items-center justify-center gap-2 text-sm sm:text-base w-full xs:w-auto",children:[e.jsx(Y,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Create Character"}),e.jsx("span",{className:"sm:hidden",children:"Create"})]})}),e.jsx(x,{href:"/settings",children:e.jsxs("button",{className:"px-4 sm:px-6 py-2.5 sm:py-3 bg-zinc-800/50 border border-orange-500/30 hover:bg-orange-500/10 hover:border-orange-500/50 rounded-xl transition-all duration-200 flex items-center justify-center gap-2 text-sm sm:text-base w-full xs:w-auto",children:[e.jsx(H,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Settings"}),e.jsx("span",{className:"sm:hidden",children:"Settings"})]})})]}):e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:I,disabled:j,className:`px-4 sm:px-6 py-2.5 sm:py-3 rounded-xl transition-all duration-200 transform hover:scale-105 flex items-center justify-center gap-2 text-sm sm:text-base w-full xs:w-auto ${b?"bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700":"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700"} ${j?"opacity-50 cursor-not-allowed":""}`,children:[e.jsx(y,{className:"w-4 h-4"}),e.jsx("span",{children:j?"Loading...":b?"Unfollow":"Follow"})]})})})]})}),e.jsx("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-3 sm:gap-4 lg:gap-6 mb-6 sm:mb-8",children:[{icon:p,title:"Characters",count:h.length.toString(),color:"text-blue-400"},{icon:y,title:"Followers",count:(N?.data?.length||0).toString(),color:"text-green-400"},{icon:p,title:"Following",count:(L?.data?.length||0).toString(),color:"text-purple-400"},{icon:u,title:"Coins",count:t?K.toLocaleString():"---",color:"text-yellow-400"}].map((r,s)=>e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-xl p-3 sm:p-4 lg:p-6 shadow-lg shadow-orange-500/10",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3",children:[e.jsx("div",{className:`w-8 h-8 sm:w-10 sm:h-10 ${r.color.replace("text-","bg-").replace("-400","-500/20")} rounded-lg flex items-center justify-center shrink-0`,children:e.jsx(r.icon,{className:`w-4 h-4 sm:w-5 sm:h-5 ${r.color}`})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("h3",{className:"text-lg sm:text-xl lg:text-2xl font-bold text-zinc-200 truncate",children:r.count}),e.jsx("p",{className:"text-xs sm:text-sm text-zinc-400 truncate",children:r.title})]})]})},s))}),e.jsx("nav",{className:"mb-6 sm:mb-8",children:e.jsx("div",{className:"bg-gradient-to-br from-zinc-800/50 to-zinc-900/50 backdrop-blur-lg border border-orange-500/20 rounded-xl p-1 shadow-lg shadow-orange-500/10",children:e.jsx("ul",{className:"flex overflow-x-auto scrollbar-hide",children:A.map(r=>e.jsx("li",{className:"flex-1 min-w-0",children:e.jsx("button",{onClick:()=>S(r),className:`w-full py-2.5 sm:py-3 px-3 sm:px-4 rounded-lg transition-all duration-200 text-sm sm:text-base whitespace-nowrap ${m===r?"bg-orange-500/20 text-orange-400 border border-orange-500/30":"text-zinc-400 hover:text-orange-300 hover:bg-orange-500/5"}`,children:r})},r))})})}),e.jsx("main",{className:"mb-6 sm:mb-8",children:G()}),e.jsx("div",{className:"text-center",children:e.jsx(M,{})})]})})};export{oe as default};
